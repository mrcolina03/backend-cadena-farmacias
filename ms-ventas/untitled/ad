Perfecto. A continuaciÃ³n te presento **la soluciÃ³n completa del mini-sistema reactivo**, **basada directamente en el estilo y conceptos del cÃ³digo que ya trabajaste en el laboratorio** (Publisherâ€“Subscriber, asincronÃ­a, errores, recuperaciÃ³n y backpressure).
Esto te sirve **tal cual para el examen** y ademÃ¡s estÃ¡ estructurado **exactamente para que puedas sacar todas las evidencias del PDF**.

---

# ðŸ“¦ Mini-Sistema Reactivo de Procesamiento de Paquetes

**Project Reactor â€“ Examen PrÃ¡ctico**

**Estudiante:** Johan SAT
*(incluido explÃ­citamente en mensajes de consola y nombre de clases, como exige el enunciado)*

---

## ðŸ§± Estructura del proyecto (OBLIGATORIA)

```
org.example
â”‚
â”œâ”€â”€ MainExamenReactivo.java
â””â”€â”€ SubscriberPaquetes.java
```

---

# ðŸ“Œ MainExamenReactivo.java

```java
package org.example;

import reactor.core.publisher.Flux;

import java.time.Duration;
import java.util.List;

public class MainExamenReactivo {

    public static void main(String[] args) {

        System.out.println("========================================");
        System.out.println("EXAMEN REACTIVO - PROCESAMIENTO DE PAQUETES");
        System.out.println("Estudiante: Johan SAT");
        System.out.println("========================================");

        // 1) Publisher: lista de pesos (20 valores)
        List<Double> pesosPaquetes = List.of(
                1.5, 2.8, 3.0, 4.2, 5.0,
                6.3, 7.1, 8.5, 9.0, 10.2,
                11.7, 12.4, 13.6, 14.9, 15.3,
                16.8, 17.5, 18.0, 19.4, 22.0 // 22 provoca error
        );

        Flux<Double> flujoPaquetes = Flux.fromIterable(pesosPaquetes)
                // 2) Flujo asÃ­ncrono
                .delayElements(Duration.ofMillis(500))

                // 3) Filtrado de paquetes vÃ¡lidos
                .filter(peso -> {
                    if (peso < 3.0) {
                        System.out.println("Paquete descartado (peso invÃ¡lido): " + peso + " kg");
                    }
                    return peso >= 3.0;
                })

                // 5) Error: paquete prohibido
                .map(peso -> {
                    if (peso > 20.0) {
                        throw new RuntimeException("Paquete prohibido detectado (>20kg): " + peso + " kg");
                    }
                    return peso;
                })

                // 4) TransformaciÃ³n: cÃ¡lculo de costo
                .map(peso -> {
                    double costo = peso * 1.25;
                    System.out.println("TransformaciÃ³n -> Peso: " + peso + " kg | Costo: $" + costo);
                    return costo;
                })

                // 6) RecuperaciÃ³n del error
                .onErrorResume(error -> {
                    System.err.println("ERROR detectado: " + error.getMessage());
                    System.err.println("Recuperando flujo con costos por defecto...");
                    return Flux.just(10.0, 12.5, 15.0, 17.5, 20.0);
                });

        // 7) Subscriber personalizado con backpressure
        flujoPaquetes.subscribe(new SubscriberPaquetes(2));

        // Mantener la app viva para flujo asÃ­ncrono
        try {
            Thread.sleep(20000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

---

# ðŸ“Œ SubscriberPaquetes.java

```java
package org.example;

import org.reactivestreams.Subscriber;
import org.reactivestreams.Subscription;

public class SubscriberPaquetes implements Subscriber<Double> {

    private final int batchSize;
    private Subscription subscription;
    private int procesados = 0;

    public SubscriberPaquetes(int batchSize) {
        this.batchSize = batchSize;
    }

    @Override
    public void onSubscribe(Subscription subscription) {
        this.subscription = subscription;
        System.out.println("onSubscribe: SuscripciÃ³n iniciada (Johan SAT)");
        System.out.println("Solicitando " + batchSize + " paquetes...");
        subscription.request(batchSize);
    }

    @Override
    public void onNext(Double costo) {
        procesados++;
        System.out.println("onNext: Costo recibido -> $" + costo + " | Total procesados: " + procesados);

        if (procesados % batchSize == 0) {
            System.out.println("Lote procesado. Solicitando siguiente lote de " + batchSize + " paquetes...");
            subscription.request(batchSize);
        }
    }

    @Override
    public void onError(Throwable throwable) {
        System.err.println("onError: Error en el flujo -> " + throwable.getMessage());
    }

    @Override
    public void onComplete() {
        System.out.println("onComplete: Procesamiento de paquetes finalizado correctamente.");
    }
}
```

---

# ðŸ§¾ CÃ³mo obtener CADA EVIDENCIA del PDF

## âœ… EVIDENCIA 1 â€” Publisher

* Captura del cÃ³digo:

```java
Flux.fromIterable(pesosPaquetes)
```

---

## âœ… EVIDENCIA 2 â€” Flujo asÃ­ncrono

* Captura del cÃ³digo:

```java
.delayElements(Duration.ofMillis(500))
```

* Captura de consola mostrando llegada progresiva (cada 500 ms).

---

## âœ… EVIDENCIA 3 â€” Filter

* CÃ³digo:

```java
.filter(peso -> peso >= 3.0)
```

* Consola mostrando:

```
Paquete descartado (peso invÃ¡lido): 1.5 kg
```

---

## âœ… EVIDENCIA 4 â€” TransformaciÃ³n

* CÃ³digo:

```java
.map(peso -> peso * 1.25)
```

* Consola:

```
TransformaciÃ³n -> Peso: 5.0 kg | Costo: $6.25
```

---

## âœ… EVIDENCIA 5 â€” Error

* CÃ³digo:

```java
if (peso > 20.0) {
    throw new RuntimeException(...)
}
```

* Consola:

```
ERROR detectado: Paquete prohibido detectado (>20kg): 22.0 kg
```

---

## âœ… EVIDENCIA 6 â€” RecuperaciÃ³n

* CÃ³digo:

```java
.onErrorResume(...)
```

* Consola:

```
Recuperando flujo con costos por defecto...
onNext: $10.0
onNext: $12.5
```

---

## âœ… EVIDENCIA 7 â€” Backpressure

* CÃ³digo del Subscriber:

```java
subscription.request(2);
```

* Consola:

```
Solicitando 2 paquetes...
Lote procesado. Solicitando siguiente lote de 2 paquetes...
```

---

Si quieres, en el siguiente mensaje puedo ayudarte a:

* Redactar **la explicaciÃ³n teÃ³rica para el PDF**
* Armar **la portada del informe**
* Preparar **respuestas tipo defensa oral**
* Simplificar el cÃ³digo si el docente pide algo mÃ¡s corto

ðŸ‘‰ **Dime quÃ© sigue y lo hacemos paso a paso.**
